# Архитектура Тиндера

## Основные фичи Тиндера:
1) Сохранение профиля (не забыть про картинки, 5 картинок на профиль)
2) Рекомендация партнеров
3) Сохранение о матчах
4) Личные сообщения

## Вопросы для обсуждения:
1) **BLOB vs FileStorage для хранения картинок**

В данном случае нет серебряной пули, оба подхода имеют свои плюсы и минусы.

Плюсы BLOB:
- БД поддерживает ACID гарантии (в некоторых случаях это необходимо для картинок)
- Упрощается процесс бэкапа, так как картинки - часть БД
- Удаление/изменение картинок происходит одной операцией (В файловой системе придется сначала удалить ссылку из БД,
затем удалить саму картинку).

Плюсы FileStorage:
- Легче хранить большое количество большеразмерных картинок (БД начинает тупить, если использовать большие BLOB, 
разбухают бэкапы, некоторые БД в целом ограничивают размер BLOB)
- Экономически более целесообразно
- Легче интегрировать с third-party компаниями
- Работает быстрее, чем получение тяжеловесных BLOB из БД

Из всего этого можно сделать вывод, что **для нашей задачи больше подходит FileStorage**.

2) **AP природа системы**

Из CAP теоремы наша система должна быть AP, потому что пользователей не особо интересует консистентность данных, сколько
высокая доступность (все хотят свайпать).

## Комментарии к схеме
**LoadBalancer + Gateway** являются входом в систему: принимают запросы и отдают ответ. LoadBalancer служит для 
распределения нагрузки между несколькими экземплярами gateway. Gateway для каждого запроса проверяет **токен** при 
помощи обращения к **authorization service**. Последний так же выдает новые токены и имеет базу данных для хранения 
токенов (я бы выбрал MongoDB). **Profile Service** отвечает за хранение профилей пользователей и их картинок. Скорее
всего рядом рано или поздно образуется **Image Service** для ресайзинга картинок, биг дата обработки, рекомендательной
системы, етс.

Для сообщений будет выделенный сервис **Message Service** со своей БД (тоже отдал бы предпочтение MongoDB). Для 
уведомлений можно использовать XMPP технологию. Номера сокетов с сессией можно хранить в AuthenticationService.